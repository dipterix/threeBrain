<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a geometry group containing multiple geometries — create_group • threeBrain</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a geometry group containing multiple geometries — create_group"><meta property="og:description" content="Create a geometry group containing multiple geometries"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- dependencies from examples --><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/threejs-0.101.1/css/dat.gui.css" rel="stylesheet"><link href="libs/dipterixThreeBrain-1.0.1/dipterix.css" rel="stylesheet"><script src="libs/dipterixThreeBrain-1.0.1/main.js"></script><script src="libs/threejs_brain-binding-0.2.6/threejs_brain.js"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threeBrain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A-getting-started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/B-electrode-localization.html">Electrode Localization</a>
    </li>
    <li>
      <a href="../articles/C-data-visualization.html">Data Visualization (Electrodes)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dipterix/threeBrain/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a geometry group containing multiple geometries</h1>
    <small class="dont-index">Source: <a href="https://github.com/dipterix/threeBrain/blob/HEAD/R/s3_geom.R" class="external-link"><code>R/s3_geom.R</code></a></small>
    <div class="hidden name"><code>create_group.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a geometry group containing multiple geometries</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_group</span><span class="op">(</span><span class="va">name</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, layer <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>name</dt>
<dd><p>string, name of the geometry</p></dd>


<dt>position</dt>
<dd><p>x,y,z location of the group</p></dd>


<dt>layer</dt>
<dd><p>layer of the group. reserved</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a GeomGroup instance</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A geometry group is a container of multiple geometries. The geometries
within the same group share the same shift and rotations (see example 1).
In ECoG/iEEG world, you might have 'MRI', 'CT', 'FreeSurfer' that have
different orientations. For example, if you want to align MRI to FreeSurfer,
Instead of calculating the position of each geometries, you can just put
all MRI components into a group, and then set transform of this group,
making the group aligned to FreeSurfer.</p>
<p>GeomGroup also can be used to store large data. To generate 3D viewer,
`threeBrain` needs to dynamically serialize data into JSON format,
which can be read by browsers. However, a FreeSurfer brain might be ~30 MB.
This is a very large size and might take ~5 seconds to serialize.
To solve this problem, GeomGroup supports cache in its `set_group_data`
method. This method supports caching static serialized data into a JSON file,
and allows the files to be loaded as static data objects. By "static", I mean
the data is not supposed to be dynamic, and it should be "read-only".
In JavaScript code, I also optimized such that you don't need to load these
large datasets repeatedly. And this allows you to load multiple subjects'
brain in a short time.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Zhengjia Wang</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: relative position</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create group</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">=</span> <span class="fu">create_group</span><span class="op">(</span><span class="st">'Group A'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create two spheres at 10,0,0, but s2 is relative to group A</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">=</span> <span class="fu"><a href="geom_sphere.html">geom_sphere</a></span><span class="op">(</span><span class="st">'Sphere 1'</span>, radius <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">=</span> <span class="fu"><a href="geom_sphere.html">geom_sphere</a></span><span class="op">(</span><span class="st">'Sphere 2'</span>, radius <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set transform (rotation)</span></span></span>
<span class="r-in"><span><span class="va">g</span><span class="op">$</span><span class="fu">set_transform</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># global position for s2 is 0,10,0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="threejs_brain.html">threejs_brain</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span></span></span>
<div id="htmlwidget-b360d070f9f756de7d41" style="width:700px;height:432.632880098888px;" class="threejs_brain html-widget"></div>
<script type="application/json" data-for="htmlwidget-b360d070f9f756de7d41">{"x":{"data_filename":"config_c8b29cc4a00bd5857b6c95b901483e64.json","settings":{"side_camera":false,"side_canvas_zoom":1,"side_canvas_width":250,"side_canvas_shift":[0,0],"color_maps":[],"default_colormap":null,"hide_controls":false,"control_center":[0,0,0],"camera_pos":[500,0,0],"font_magnification":1,"start_zoom":1,"show_legend":true,"render_timestamp":true,"control_presets":null,"cache_folder":"lib/threebrain_data-0/","lib_path":"lib/","default_controllers":[],"debug":false,"background":"#FFFFFF","token":null,"coords":null,"show_inactive_electrodes":true,"side_display":true,"control_display":true,"custom_javascript":null},"force_render":true},"evals":[],"jsHooks":[]}</script><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: cache</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># download N27 brain</span></span></span>
<span class="r-in"><span><span class="co"># Make sure you have N27 brain downloaded to `default_template_directory()`</span></span></span>
<span class="r-in"><span><span class="co"># download_N27()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">template_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="default_template_directory.html">default_template_directory</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu">threeBrain</span><span class="fu">::</span><span class="fu"><a href="read_fs_asc.html">read_fs_asc</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">template_dir</span>, <span class="st">'N27/surf/lh.pial.asc'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vertex</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">face</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">faces</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. dynamically serialize</span></span></span>
<span class="r-in"><span><span class="va">mesh</span> <span class="op">=</span> <span class="fu"><a href="geom_freemesh.html">geom_freemesh</a></span><span class="op">(</span><span class="st">'lh'</span>, vertex <span class="op">=</span> <span class="va">vertex</span>, face <span class="op">=</span> <span class="va">face</span>, layer <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. cache</span></span></span>
<span class="r-in"><span><span class="co"># Create group, all geometries in this group are relatively positioned</span></span></span>
<span class="r-in"><span><span class="va">tmp_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mesh</span> <span class="op">=</span> <span class="fu"><a href="geom_freemesh.html">geom_freemesh</a></span><span class="op">(</span><span class="st">'Left Hemisphere cached'</span>, vertex <span class="op">=</span> <span class="va">vertex</span>,</span></span>
<span class="r-in"><span>                     face <span class="op">=</span> <span class="va">face</span>, cache_file <span class="op">=</span> <span class="va">tmp_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zhengjia Wang, John Magnotti, Michael Beauchamp.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

