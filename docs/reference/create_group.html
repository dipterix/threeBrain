<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a geometry group containing multiple geometries — create_group • threeBrain</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a geometry group containing multiple geometries — create_group" />
<meta property="og:description" content="Create a geometry group containing multiple geometries" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threeBrain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dipterix/threeBrain">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a geometry group containing multiple geometries</h1>
    <small class="dont-index">Source: <a href='https://github.com/dipterix/threeBrain/blob/master/R/s3_geom.R'><code>R/s3_geom.R</code></a></small>
    <div class="hidden name"><code>create_group.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a geometry group containing multiple geometries</p>
    </div>

    <pre class="usage"><span class='fu'>create_group</span>(<span class='no'>name</span>, <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>), <span class='kw'>layer</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>name</th>
      <td><p>string, name of the geometry</p></td>
    </tr>
    <tr>
      <th>position</th>
      <td><p>x,y,z location of the group</p></td>
    </tr>
    <tr>
      <th>layer</th>
      <td><p>layer of the group. reserved</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a GeomGroup instance</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A geometry group is a container of multiple geometries. The geometries
within the same group share the same shift and rotations (see example 1).
In ECoG/iEEG world, you might have 'MRI', 'CT', 'FreeSurfer' that have
different orientations. For example, if you want to align MRI to FreeSurfer,
Instead of calculating the position of each geometries, you can just put
all MRI components into a group, and then set transform of this group,
making the group aligned to FreeSurfer.</p>
<p>GeomGroup also can be used to store large data. To generate 3D viewer,
`threeBrain` needs to dynamically serialize data into JSON format,
which can be read by browsers. However, a FreeSurfer brain might be ~30 MB.
This is a very large size and might take ~5 seconds to serialize.
To solve this problem, GeomGroup supports cache in its `set_group_data`
method. This method supports caching static serialized data into a JSON file,
and allows the files to be loaded as static data objects. By "static", I mean
the data is not supposed to be dynamic, and it should be "read-only".
In JavaScript code, I also optimized such that you don't need to load these
large datasets repeatedly. And this allows you to load multiple subjects'
brain in a short time.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example 1: relative position</span>

<span class='co'># create group</span>
<span class='no'>g</span> <span class='kw'>=</span> <span class='fu'>create_group</span>(<span class='st'>'Group A'</span>)

<span class='co'># create two spheres at 10,0,0, but s2 is relative to group A</span>
<span class='no'>s1</span> <span class='kw'>=</span> <span class='fu'><a href='geom_sphere.html'>geom_sphere</a></span>(<span class='st'>'Sphere 1'</span>, <span class='kw'>radius</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>))
<span class='no'>s2</span> <span class='kw'>=</span> <span class='fu'><a href='geom_sphere.html'>geom_sphere</a></span>(<span class='st'>'Sphere 2'</span>, <span class='kw'>radius</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>g</span>)

<span class='co'># set transform (rotation)</span>
<span class='no'>g</span>$<span class='fu'>set_transform</span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
  <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,
  <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>
), <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>))

<span class='co'># global position for s2 is 0,10,0</span>
<span class='fu'><a href='threejs_brain.html'>threejs_brain</a></span>(<span class='no'>s1</span>, <span class='no'>s2</span>)

<span class='co'># Example 2: cache</span>
<span class='co'># \donttest{</span>
<span class='co'># download N27 brain</span>
<span class='co'># Make sure you have N27 brain downloaded to ~/rave_data/others/threeBrain/N27</span>
<span class='co'># download_N27()</span>

<span class='no'>dat</span> <span class='kw'>=</span> <span class='kw pkg'>threeBrain</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/threeBrain/man/read_fs_asc.html'>read_fs_asc</a></span>(<span class='st'>'~/rave_data/others/three_brain/N27/surf/lh.pial.asc'</span>)
<span class='no'>vertex</span> <span class='kw'>=</span> <span class='no'>dat</span>$<span class='no'>vertices</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>]
<span class='no'>face</span> <span class='kw'>=</span> <span class='no'>dat</span>$<span class='no'>faces</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>]

<span class='co'># 1. dynamically serialize</span>
<span class='no'>mesh</span> <span class='kw'>=</span> <span class='fu'><a href='geom_freemesh.html'>geom_freemesh</a></span>(<span class='st'>'lh'</span>, <span class='kw'>vertex</span> <span class='kw'>=</span> <span class='no'>vertex</span>, <span class='kw'>face</span> <span class='kw'>=</span> <span class='no'>face</span>, <span class='kw'>layer</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='kw pkg'>pryr</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pryr/man/object_size.html'>object_size</a></span>(<span class='no'>mesh</span>) <span class='co'># ~10 MB</span></div><div class='output co'>#&gt; <span class='message'>Registered S3 method overwritten by 'pryr':</span>
#&gt; <span class='message'>  method      from</span>
#&gt; <span class='message'>  print.bytes Rcpp</span></div><div class='output co'>#&gt; 8.42 MB</div><div class='input'><span class='fu'><a href='threejs_brain.html'>threejs_brain</a></span>(<span class='no'>mesh</span>) <span class='co'># ~3 seconds to serialize</span>

<span class='co'># 2. cache</span>
<span class='co'># Create group, all geometries in this group are relatively positioned</span>
<span class='no'>tmp_file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>()
<span class='no'>mesh</span> <span class='kw'>=</span> <span class='fu'><a href='geom_freemesh.html'>geom_freemesh</a></span>(<span class='st'>'Left Hemisphere cached'</span>, <span class='kw'>vertex</span> <span class='kw'>=</span> <span class='no'>vertex</span>,
                     <span class='kw'>face</span> <span class='kw'>=</span> <span class='no'>face</span>, <span class='kw'>cache_file</span> <span class='kw'>=</span> <span class='no'>tmp_file</span>)</div><div class='output co'>#&gt; Creating cache data to - /var/folders/rh/4bkfl5z50wgbbjd85xvc695c0000gn/T//RtmpE2c8c2/file17a6b550418</div><div class='input'><span class='kw pkg'>pryr</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pryr/man/object_size.html'>object_size</a></span>(<span class='no'>mesh</span>) <span class='co'># ~0.5 MB</span></div><div class='output co'>#&gt; 343 kB</div><div class='input'><span class='fu'><a href='threejs_brain.html'>threejs_brain</a></span>(<span class='no'>mesh</span>) <span class='co'># serialize at once, load in browser</span>


<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Zhengjia Wang</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zhengjia Wang, John Magnotti, Brian Metzger, Michael Beauchamp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


